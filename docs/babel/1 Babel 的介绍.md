# Babel 编译流程笔记

## 编译器与转译器的区别

- **编译器(Compiler)**：将高级语言转换为低级语言的工具

  - 高级语言：如 C++、JavaScript，接近人类思维，包含分支、循环等逻辑特性
  - 低级语言：如汇编语言、机器语言，与硬件和执行细节相关

- **转译器(Transpiler)**：将高级语言转换为另一种高级语言的工具
  - Babel 就是一个 JavaScript 转译器

## Babel 的三步编译流程

### 1. Parse（解析）

- 目的：将源码字符串转换为 AST（抽象语法树）
- 包含两个步骤：
  - 词法分析：将代码分解成 Token（最小单位的字符串）
  - 语法分析：将 Token 递归组装成 AST

### 2. Transform（转换）

- 对 AST 进行遍历和处理
- 通过 visitor 函数对 AST 节点进行增删改
- 返回新的 AST
- 这是 Babel 最核心的部分

### 3. Generate（生成）

- 将转换后的 AST 打印成目标代码字符串
- 生成 Sourcemap（用于调试和错误追踪）
- 不同的 AST 节点会生成对应结构的代码字符串

## 为什么需要这三步？

1. **Parse 的必要性**：

   - 计算机需要理解源码，必须将字符串转换为数据结构（AST）
   - AST 省略了分隔符等无具体意义的符号，因此称为"抽象"语法树

2. **Transform 的必要性**：

   - 有了 AST 后才能进行代码转换
   - 通过修改 AST 来实现代码转换

3. **Generate 的必要性**：
   - 需要将 AST 转回字符串形式
   - 在转换过程中加回必要的分隔符
   - 生成 Sourcemap 用于调试和错误追踪

## Sourcemap 的作用

- 记录源码到目标代码的转换关系
- 用于调试时将编译后代码映射回源码
- 帮助定位线上报错在源码中的位置
