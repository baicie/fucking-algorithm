### Babel 的原理
babel是js编译器，它能将开发者在开发过程中的，直接使用各类方言（ts，jsx）或者新的语法特性，而不需要考虑运行环境，因为babel可以做到按需转换为低版本支持的代码；babel内部原理是将js代码转换为AST，对AST应用各种插件进行处理，最终输出编译后的js代码

#### AST抽象语法树
简单定义：以树的形式来表现编程语言的语法结构

AST是源码的高效表示，能便捷的表示大多数编程语言的结构。适用于做代码分析或转换等需求。之所以用树来进行分析或转换，是因为树能使得程序中的每一节点恰好被访问一次（前序或者后续遍历）

常见的使用场景：代码压缩混淆功能

#### Babel编译流程
三大步骤
1. 解析阶段：模式使用@babel/parse将代码转换成AST。解析一般分为两个阶段：词法分析和语法分析
    - 词法分析：对输入的字符序列做标记化操作
    - 语法分析：处理标记与标记之间的关系，最终形成一颗完成的AST结构

2. 转换阶段：babel使用@babel/traverse提供的方法对AST进行深度优先遍历，调用插件对关注节点的处理函数，按需对AST节点进行增删改操作
3. 生成阶段：Babel默认使用@babel/generator将上一阶段处理后的AST转换为代码字符串

#### Babel的插件系统
perset是以plugin和perset以及其他配置的集合。babel会递归读取preset，最终获取一个plugins数组用于后续的操作
常见的perset有 env/typescript/react
env预设包含了一组最新浏览器已支持的es语法特性，并且可以通过配置目标运行环境范围，自动按需引入插件

编写Babel插件
babel插件的写法是借助访问者模式对关注的节点定义处理函数
转换阶段 babel会按照以下顺序执行 所有插件的pre方法 按需执行visitor的方法 执行所有插件的post方法

在对AST进行深度优先遍历的过程中，会创建TraversalContext对象来把控NodePath节点的访问，访问时调用对节点所定义的处理方法，从而实现按需执行visitor中的方法